\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{pset2\_part1\_you-chi\_liu}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{-\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{problem-set-2-part-one}{%
\section{Problem set 2: part one}\label{problem-set-2-part-one}}

Total points: 20

Fraction of problem set two points: 25\%

\textbf{Concepts}: here, you're going to start using the SIP H-2A
employer jobs and debarment data to practice exact matching, regex, and
fuzzy matching

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{165}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{} helpful packages}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{random}
\PY{k+kn}{import} \PY{n+nn}{re}
\PY{k+kn}{import} \PY{n+nn}{recordlinkage}
\PY{o}{!} pip install recordlinkage

\PY{c+c1}{\PYZsh{}\PYZsh{} repeated printouts}
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{core}\PY{n+nn}{.}\PY{n+nn}{interactiveshell} \PY{k+kn}{import} \PY{n}{InteractiveShell}
\PY{n}{InteractiveShell}\PY{o}{.}\PY{n}{ast\PYZus{}node\PYZus{}interactivity} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{all}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Requirement already satisfied: recordlinkage in /opt/conda/lib/python3.8/site-
packages (0.14)
Requirement already satisfied: numpy>=1.13.0 in /opt/conda/lib/python3.8/site-
packages (from recordlinkage) (1.20.2)
Requirement already satisfied: scikit-learn>=0.19.0 in
/opt/conda/lib/python3.8/site-packages (from recordlinkage) (0.24.1)
Requirement already satisfied: joblib in /opt/conda/lib/python3.8/site-packages
(from recordlinkage) (1.0.1)
Requirement already satisfied: pandas>=0.25 in /opt/conda/lib/python3.8/site-
packages (from recordlinkage) (1.2.4)
Requirement already satisfied: jellyfish>=0.5.4 in
/opt/conda/lib/python3.8/site-packages (from recordlinkage) (0.8.2)
Requirement already satisfied: scipy>=1 in /opt/conda/lib/python3.8/site-
packages (from recordlinkage) (1.6.2)
Requirement already satisfied: python-dateutil>=2.7.3 in
/opt/conda/lib/python3.8/site-packages (from pandas>=0.25->recordlinkage)
(2.8.1)
Requirement already satisfied: pytz>=2017.3 in /opt/conda/lib/python3.8/site-
packages (from pandas>=0.25->recordlinkage) (2021.1)
Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.8/site-
packages (from python-dateutil>=2.7.3->pandas>=0.25->recordlinkage) (1.15.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in
/opt/conda/lib/python3.8/site-packages (from scikit-
learn>=0.19.0->recordlinkage) (2.1.0)
    \end{Verbatim}

    \hypertarget{regex-and-exact-matching-8-points}{%
\section{1. Regex and exact matching (8
points)}\label{regex-and-exact-matching-8-points}}

    \hypertarget{load-data-on-debarments-and-job-postings-0-points}{%
\section{1.1 Load data on debarments and job postings (0
points)}\label{load-data-on-debarments-and-job-postings-0-points}}

Load the following datasets stored in \texttt{pset2\_part1\_inputdata}

\begin{itemize}
\tightlist
\item
  Historical H2A debarments (debar.csv); call this \texttt{debar}
\item
  Q1 2021 H2A job postings (jobs.csv); call this \texttt{jobs}
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{166}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{debar} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{debar.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{jobs} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{jobs.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{try-exact-merge-on-business-name-2-points}{%
\subsubsection{1.2 Try exact merge on business name (2
points)}\label{try-exact-merge-on-business-name-2-points}}

\begin{itemize}
\tightlist
\item
  Use the \texttt{EMPLOYER\_NAME} field of jobs
\item
  Use the \texttt{Name} field of debar
\end{itemize}

A. Use pd.merge with an inner join on those fields to see whether there
are any exact matches.

B. If there are matches, print the name in each dataset, date range of
debarment (\texttt{Start\ date} and \texttt{End\ date} in
\texttt{debar}) and location from each data (\texttt{City,\ State} in
\texttt{debar} and \texttt{EMPLOYER\_CITY} and \texttt{EMPLOYER\_STATE}
in \texttt{jobs})

\textbf{Resources}: - Slides 17-19 here:
https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/slides/qss20\_s21\_class4.pdf
- Code here:
https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/activities/03\_merging\_session1.ipynb

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{167}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{}A. Use pd.merge with an inner join on those fields to see whether there are any exact matches. }

\PY{n}{merge\PYZus{}name} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{jobs}\PY{p}{,} \PY{n}{debar} \PY{p}{,}
\PY{n}{how} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inner}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{EMPLOYER\PYZus{}NAME}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{}\PYZsh{}B}
\PY{n}{matched\PYZus{}debar} \PY{o}{=} \PY{n}{debar}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{merge\PYZus{}name}\PY{o}{.}\PY{n}{Name}\PY{p}{)}\PY{p}{]}               
\PY{n}{matched\PYZus{}debar} \PY{o}{=} \PY{n}{matched\PYZus{}debar}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City, State}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Start date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{End date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{matched\PYZus{}job} \PY{o}{=} \PY{n}{jobs}\PY{p}{[}\PY{n}{jobs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{merge\PYZus{}name}\PY{o}{.}\PY{n}{EMPLOYER\PYZus{}NAME}\PY{p}{)}\PY{p}{]}               
\PY{n}{matched\PYZus{}job} \PY{o}{=} \PY{n}{matched\PYZus{}job}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}CITY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{EMPLOYER\PYZus{}STATE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}                                                                     

\PY{c+c1}{\PYZsh{}Match in debar}
\PY{n}{matched\PYZus{}debar}
\PY{c+c1}{\PYZsh{}Matches in jobs}
\PY{n}{matched\PYZus{}job}
\PY{c+c1}{\PYZsh{}Match combined}
\PY{n}{merge\PYZus{}name}\PY{o}{=}\PY{n}{merge\PYZus{}name}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Start date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{End date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{City, State}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{EMPLOYER\PYZus{}CITY}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{EMPLOYER\PYZus{}STATE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{merge\PYZus{}name}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{167}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
              Name       City, State Start date   End date
63  Rafael Barajas  Sebring, Florida  9/23/2016  9/22/2017
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{167}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      EMPLOYER\_NAME   EMPLOYER\_CITY EMPLOYER\_STATE
791  Rafael Barajas  Port St. Lucie             FL
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{167}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
             Name   EMPLOYER\_NAME Start date   End date       City, State  \textbackslash{}
0  Rafael Barajas  Rafael Barajas  9/23/2016  9/22/2017  Sebring, Florida

    EMPLOYER\_CITY EMPLOYER\_STATE
0  Port St. Lucie             FL
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{targeted-regex}{%
\subsection{1.3 Targeted regex}\label{targeted-regex}}

You want to see if you can increase the exact match rate with some basic
cleaning of each of the name fields.

    A. Convert the names \texttt{EMPLOYER\_NAME} and \texttt{Name} to
uppercase using list comprehension rather than df.varname.str.upper()

B. Print a random sample of 15 values of each result

C. Assign them back to the original data, writing over the original
columns

\textbf{Resources}: - \texttt{new\_colnames} line of code here for
example of list comprehension:
https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/activities/04\_basicregex\_formerging.ipynb
- Sampling from a list without replacement using the \texttt{random}
module: https://note.nkmk.me/en/python-random-choice-sample-choices/

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{168}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{} A. Convert the names `EMPLOYER\PYZus{}NAME` and `Name` to uppercase using list comprehension }
\PY{c+c1}{\PYZsh{}\PYZsh{} rather than df.varname.str.upper()}
\PY{n}{upper\PYZus{}employer} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{jobs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{upper\PYZus{}name} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}


\PY{c+c1}{\PYZsh{}\PYZsh{} B. Print a random sample of 15 values of each result}
\PY{n}{random}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{upper\PYZus{}employer}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
\PY{n}{random}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{upper\PYZus{}name}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}

\PY{c+c1}{\PYZsh{}\PYZsh{} C.Assign them back to the original data, writing over the original columns}
\PY{n}{jobs}\PY{o}{.}\PY{n}{EMPLOYER\PYZus{}NAME}\PY{o}{=}\PY{n}{upper\PYZus{}employer}
\PY{n}{debar}\PY{o}{.}\PY{n}{Name}\PY{o}{=}\PY{n}{upper\PYZus{}name}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{168}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['ZACH BULLOCK FARMS FKA BULLOCK FARMS',
 'ALOIS H CRAMER FARMS',
 'G. F. \& P. ZAUNBRECHER FARMS',
 'NOEL QUINTINO ENCINA',
 'MATTHEW PERRON',
 'PARK RANCH, LLC',
 'HOTCHKISS RANCHES, INC.',
 '701 HARVESTING, LLC',
 'ALTMAN SPECIALTY PLANTS, LLC - CA VISTA',
 'AGRICO LABOR LLC',
 'SOFFEL HONEY COMPANY INC.',
 'ROJAS AVILA HARVESTING, LLC',
 'JOHN L ZAUNBRECHER',
 'CHARLIE JOHNSON FARMS',
 'GALLOWAY COTTON FARM']
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{168}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['M KENESTON CORP',
 'OMEGA LAMB, LLC',
 'RB FARM PICKING, INC',
 'DELIA ROJAS',
 'CADDO CREEK RANCH, DBA PARADISE RANCH',
 'JESUS LEDESMA',
 'VALLEY VIEW ORCHARDS',
 'SLASH E.V. RANCH LLP',
 'E.V. RANCH LLP',
 'MAPLE RIDGE CUSTOM SERVICES, LLC',
 'JOHN \& NETA LEOPKY FARMS',
 'TRINITY LIVESTOCK PARTNERSHIP',
 'DOVE CREEK FARMS',
 'F\&W FARMS',
 'OLD TREE FARMS/VERPAALEN CUSTOM SERVICE']
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{cleaning-up-punctuation-4-points}{%
\subsubsection{1.3.2 Cleaning up punctuation (4
points)}\label{cleaning-up-punctuation-4-points}}

You notice that INC, CO, and LLC are sometimes followed by a . but
sometimes not

A. For each dataset, write a regex pattern to remove the . but only if
it's preceded by INC, LLC, or CO

Make sure LLC, INC, CO remain part of the string but just without the
dot

B. Test the pattern on the positive and negative example and print the
result. The first positive example should return
\texttt{CISCO\ PRODUCE\ INC}; the second positive example should return
\texttt{AVOYELLES\ HONEY\ CO,\ LLC} the negative example should return
\texttt{E.V.\ RANCH\ LLP} (so leave the dots between E.V. in)

C. Execute on (1) Name in \texttt{debar} (can just write over the col)
and (3) EMPLOYER\_NAME in \texttt{jobs}, making sure to use the
uppercase versions of the variables

\textbf{Hint}:
https://stackoverflow.com/questions/7191209/python-re-sub-replace-with-matched-content

\textbf{Resources}: - Regex slides are 22-40:
https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/slides/qss20\_s21\_class4.pdf
- Regex code:
https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/activities/04\_basicregex\_formerging.ipynb

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{169}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pos\PYZus{}example\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{CISCO PRODUCE INC.}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{pos\PYZus{}example\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AVOYELLES HONEY CO., LLC}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{neg\PYZus{}example} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{E.V. RANCH LLP}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{170}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{} A \PYZam{} B}


\PY{n}{pattern01} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{([INC|CO|LLC])}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{pattern02}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{pattern01}\PY{p}{,} \PY{n}{pattern02}\PY{p}{,} \PY{n}{pos\PYZus{}example\PYZus{}1}\PY{p}{)}
\PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{pattern01}\PY{p}{,} \PY{n}{pattern02}\PY{p}{,} \PY{n}{pos\PYZus{}example\PYZus{}2}\PY{p}{)}
\PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{pattern01}\PY{p}{,} \PY{n}{pattern02}\PY{p}{,} \PY{n}{neg\PYZus{}example}\PY{p}{)}

\PY{c+c1}{\PYZsh{}\PYZsh{} C}

    
\PY{n}{debar}\PY{o}{.}\PY{n}{Name} \PY{o}{=} \PY{p}{[}\PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{pattern01}\PY{p}{,} \PY{n}{pattern02}\PY{p}{,} \PY{n}{name}\PY{p}{)} 
                   \PY{k}{for} \PY{n}{name} \PY{o+ow}{in} \PY{n}{debar}\PY{o}{.}\PY{n}{Name}\PY{p}{]}

\PY{n}{jobs}\PY{o}{.}\PY{n}{EMPLOYER\PYZus{}NAME} \PY{o}{=} \PY{p}{[}\PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{pattern01}\PY{p}{,} \PY{n}{pattern02}\PY{p}{,} \PY{n}{name}\PY{p}{)} 
                   \PY{k}{for} \PY{n}{name} \PY{o+ow}{in} \PY{n}{jobs}\PY{o}{.}\PY{n}{EMPLOYER\PYZus{}NAME}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{170}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
'CISCO PRODUCE INC'
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{170}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
'AVOYELLES HONEY CO, LLC'
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{170}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
'E.V. RANCH LLP'
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{optional-extra-credit---regex-to-separate-companies-from-individuals-2-points}{%
\subsubsection{1.3.3 OPTIONAL extra credit - regex to separate companies
from individuals (2
points)}\label{optional-extra-credit---regex-to-separate-companies-from-individuals-2-points}}

You notice some employers in \texttt{debar} have both the name of the
company and the name of individual, e.g.:

COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMSON (INDIVIDUAL)*

Use the uppercase/cleaned version of the Name in \texttt{debar}

A. Write a regex pattern that does the following: - Captures the pattern
that occurs before COMPANY if (COMPANY) is in string-- so in above,
extracts COUNTY FAIR FARM - Captures the pattern that occurs before
INDIVIDUAL if (INDIVIDUAL) is also in string -- so in above, extracts
ANDREW WILLIAMSON (so omit the and)

B. Test the pattern on \texttt{pos\_example} and \texttt{neg\_example}--
make sure former returns a list (if using find.all) or match object (if
using re.search) with the company name and individual name separated
out; make sure latter returns empty

C. Iterate over the cleaned \texttt{Name} column in debar and execute
the regex. Use it to create two new columns in debar: - A column for
company (full Name string if left as is; pattern before COMPANY if one
extracted) - A column for individual (full Name string if left as is;
pattern before INDIVIDUAL if one extracted)

D. Print those columns for the rows containing the negative example and
positive example

\textbf{Hint}: for step A, you can either use re.search, re.match, or
re.findall; don't worry about matching B\&R Harvesting and Paul Cruz
(Individual)

For step C, you probably want to use a loop or function that uses if
else to do different things if a match is found or not

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{171}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pos\PYZus{}example} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMSON (INDIVIDUAL)*}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{neg\PYZus{}example} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{CISCO PRODUCE INC}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}A\PYZam{}B}
\PY{n}{pattern03}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZca{}(.*)([(]COMPANY[)])}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{s*(AND)}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{s*(.*)([(]INDIVIDUAL[)])(}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{*?)}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{re}\PY{o}{.}\PY{n}{findall}\PY{p}{(}\PY{n}{pattern03}\PY{p}{,}\PY{n}{pos\PYZus{}example}\PY{p}{)}
\PY{n}{re}\PY{o}{.}\PY{n}{findall}\PY{p}{(}\PY{n}{pattern03}\PY{p}{,}\PY{n}{neg\PYZus{}example}\PY{p}{)}


\PY{n}{debar}\PY{o}{.}\PY{n}{Name}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{string}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{c+c1}{\PYZsh{}C}
\PY{n}{added} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{name} \PY{o+ow}{in} \PY{p}{(}\PY{n}{debar}\PY{o}{.}\PY{n}{Name}\PY{p}{)}\PY{p}{:}
    \PY{n}{name\PYZus{}check}\PY{o}{=}\PY{n}{re}\PY{o}{.}\PY{n}{findall}\PY{p}{(}\PY{n}{pattern}\PY{p}{,}\PY{n}{name}\PY{p}{)}
    \PY{k}{if}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{name\PYZus{}check}\PY{p}{)}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{:} 
        \PY{n}{sth}\PY{o}{=}\PY{n}{debar}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{==}\PY{n}{name}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{values}
        \PY{n}{sth}\PY{o}{=}\PY{n}{sth}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{int}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sth}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{company}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{name}
        \PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sth}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{individual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{name}
        \PY{n}{data}\PY{o}{=}\PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{name}\PY{p}{]}
        \PY{n}{added}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{data}\PY{p}{)}
    \PY{k}{if}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{name\PYZus{}check}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:} 
        \PY{n}{name\PYZus{}check}\PY{o}{=}\PY{n}{name\PYZus{}check}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{sth}\PY{o}{=}\PY{n}{debar}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{==}\PY{n}{name}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{values}
        \PY{n}{sth}\PY{o}{=}\PY{n}{sth}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{int}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sth}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{company}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{name\PYZus{}check}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sth}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{individual}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{name\PYZus{}check}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
        \PY{n}{data}\PY{o}{=}\PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{name}\PY{p}{]}
        \PY{n}{added}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\PY{n}{final} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{added}\PY{p}{)}
\PY{n}{final}\PY{o}{=}\PY{n}{final}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}    
\PY{n}{final}
\PY{c+c1}{\PYZsh{}D}
\PY{n}{pos}\PY{o}{=}\PY{n}{final}\PY{p}{[}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMSON (INDIVIDUAL)*}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}
\PY{n}{neg}\PY{o}{=}\PY{n}{final}\PY{p}{[}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{CISCO PRODUCE INC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}
\PY{n}{pos}
\PY{n}{neg}       
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[('COUNTY FAIR FARM ',
  '(COMPANY)',
  'AND',
  'ANDREW WILLIAMSON ',
  '(INDIVIDUAL)',
  '*')]
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[]
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
0                                   J\&J HARVESTING
1                           STAHLMAN APIARIES, INC
2                                    TRUST NURSERY
3                             ANTON FERTILIZER INC
4                  GREAT PLAINS FLUID SERVICE, INC
                          {\ldots}
109                               DOVE CREEK FARMS
110                                  JESUS LEDESMA
111                                   TURNER FARMS
112    B \& R HARVESTING AND PAUL CRUZ (INDIVIDUAL)
113                                    DELIA ROJAS
Name: Name, Length: 114, dtype: string
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                                  Name       City, State  \textbackslash{}
0                                       J\&J HARVESTING         Leads, ND
1                               STAHLMAN APIARIES, INC         Selby, SD
2                                        TRUST NURSERY       Pulaski, NY
3                                 ANTON FERTILIZER INC       Dighton, KS
4                      GREAT PLAINS FLUID SERVICE, INC    Greensburg, KS
..                                                 {\ldots}               {\ldots}
107                                       WALKER PLACE      Danville, IL
108  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS{\ldots}     Jefferson, ME
110                                      JESUS LEDESMA      Mulberry, FL
112        B \& R HARVESTING AND PAUL CRUZ (INDIVIDUAL)  Collins, Georgia
113                                        DELIA ROJAS    Lyons, Georgia

                                             Violation  Duration  Start date  \textbackslash{}
0       Failure to respond to audit (partial response)   2 years   1/19/2014
1       Failure to respond to audit (partial response)    1 year   2/19/2015
2       Failure to respond to audit (partial response)    1 year   3/21/2014
3            Failure to respond to audit (no response)   2 years   3/30/2014
4            Failure to respond to audit (no response)   2 years   3/30/2014
..                                                 {\ldots}       {\ldots}         {\ldots}
107  Failure to comply with the employer's obligati{\ldots}  2 months  11/19/2019
108                                      WHD Debarment   3 years    3/8/2017
110                Failure to Respond to Audit Request   2 years      2/8/18
112                                      WHD Debarment   3 years      4/9/17
113                                      WHD Debarment   3 years     4/14/17

      End date                                      company  \textbackslash{}
0    1/18/2016                               J\&J HARVESTING
1    2/14/2016                       STAHLMAN APIARIES, INC
2    3/20/2015                                TRUST NURSERY
3    3/29/2016                         ANTON FERTILIZER INC
4    3/29/2016              GREAT PLAINS FLUID SERVICE, INC
..         {\ldots}                                          {\ldots}
107  1/26/2020                                 WALKER PLACE
108   3/8/2020                            COUNTY FAIR FARM
110     2/8/20                                JESUS LEDESMA
112     4/9/20  B \& R HARVESTING AND PAUL CRUZ (INDIVIDUAL)
113    4/14/20                                  DELIA ROJAS

                                      individual
0                                 J\&J HARVESTING
1                         STAHLMAN APIARIES, INC
2                                  TRUST NURSERY
3                           ANTON FERTILIZER INC
4                GREAT PLAINS FLUID SERVICE, INC
..                                           {\ldots}
107                                 WALKER PLACE
108                           ANDREW WILLIAMSON
110                                JESUS LEDESMA
112  B \& R HARVESTING AND PAUL CRUZ (INDIVIDUAL)
113                                  DELIA ROJAS

[114 rows x 8 columns]
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                                  Name    City, State  \textbackslash{}
108  COUNTY FAIR FARM (COMPANY) AND ANDREW WILLIAMS{\ldots}  Jefferson, ME

         Violation Duration Start date  End date            company  \textbackslash{}
108  WHD Debarment  3 years   3/8/2017  3/8/2020  COUNTY FAIR FARM

             individual
108  ANDREW WILLIAMSON
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                 Name City, State                                   Violation  \textbackslash{}
19  CISCO PRODUCE INC   Cairo, GA   Failure to respond to audit (no response)
56  CISCO PRODUCE INC   Cairo, GA  Impeding the Audit Process â€“ Non- Response

   Duration  Start date   End date            company         individual
19  2 years  12/10/2014  12/9/2016  CISCO PRODUCE INC  CISCO PRODUCE INC
56  2 years  12/10/2015  12/9/2017  CISCO PRODUCE INC  CISCO PRODUCE INC
\end{Verbatim}
\end{tcolorbox}
        # 1.4 Fuzzy matching to match debarments to jobs (12 points)

    \hypertarget{preprocessing-location-2-points}{%
\subsubsection{1.4.1 Preprocessing location (2
points)}\label{preprocessing-location-2-points}}

You want to block on state but notice that states in \texttt{debar} have
a mix of two digit codes and full state names (e.g., GA versus Georgia)
while states in \texttt{jobs} are all two-digit codes

A. Run the code below to load the \texttt{states} crosswalk. Use that
crosswalk to create a field in \texttt{debar} that has the two-digit
state abbreviation for all locations (hint: you may need to first split
the string on the ``,'' or use str.replace to extract the state)

B. Use an \texttt{assert} statement to check that all the states in
\texttt{debar} are two-digits after the cleaning

\textbf{Notes}: you can filter out states that are NaN

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{173}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{states} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{states\PYZus{}pset2.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}pre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{debar}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{City, State}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{string}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZca{}(.*?)}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{,}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{regex} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}
\PY{n}{debar}\PY{o}{=}\PY{n}{debar}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{debar}\PY{o}{.}\PY{n}{state\PYZus{}pre}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{debar}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{state\PYZus{}not2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{debar}\PY{o}{.}\PY{n}{state\PYZus{}pre}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{len}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{2}\PY{p}{,} \PY{k+kc}{True}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)}

\PY{n}{state\PYZus{}uncleaned} \PY{o}{=} \PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}not2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==}\PY{k+kc}{True}\PY{p}{]}

\PY{n}{state\PYZus{}uncleaned} \PY{o}{=} \PY{n}{state\PYZus{}uncleaned}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}pre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}pre2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}


\PY{n}{states}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{states}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Code}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{string}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{states}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Description}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{states}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Description}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{string}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{merge\PYZus{}state} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{state\PYZus{}uncleaned}\PY{p}{,} \PY{n}{states}\PY{p}{,}
\PY{n}{how} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inner}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{state\PYZus{}pre2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Description}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{state\PYZus{}cleaned} \PY{o}{=} \PY{n}{debar}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{debar}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}not2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==}\PY{k+kc}{False}\PY{p}{]}
\PY{n}{merge\PYZus{}state} \PY{o}{=} \PY{n}{merge\PYZus{}state}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}pre2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}not2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Description}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{merge\PYZus{}state} \PY{o}{=} \PY{n}{merge\PYZus{}state}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}pre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{state\PYZus{}cleaned} \PY{o}{=} \PY{n}{state\PYZus{}cleaned}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{state\PYZus{}not2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{debar\PYZus{}new} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{merge\PYZus{}state}\PY{p}{,} \PY{n}{state\PYZus{}cleaned}\PY{p}{]}\PY{p}{)}
\PY{n}{debar\PYZus{}new} \PY{o}{=} \PY{n}{debar\PYZus{}new}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state\PYZus{}pre}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{k}{assert} \PY{n+nb}{all}\PY{p}{(}\PY{n}{debar\PYZus{}new}\PY{o}{.}\PY{n}{state}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{len}\PY{p}{(}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{All the states in debar are not two\PYZhy{}digits after the cleaning}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{step-by-step-fuzzy-matching-4-points}{%
\subsubsection{1.4.2 step by step fuzzy matching (4
points)}\label{step-by-step-fuzzy-matching-4-points}}

    A. Write fuzzy matching code (don't yet put inside a user-defined
function) that:

\begin{itemize}
\tightlist
\item
  Blocks on two-digit state code
\item
  Finds matches based on similarity between the employer name
  (\texttt{Name}) in \texttt{debar} (uppercase and cleaned) and
  \texttt{EMPLOYER\_NAME} in \texttt{jobs} (uppercase and cleaned). You
  can choose which distance metric and threshold to use (feel free to
  set a threshold low enough to get some matches even if that leads to
  some false positives).
\end{itemize}

For the steps after compute, just take any match with non-zero value
rather than using a classifier (so skip the k-means or e-m step in the
example code)

B. Print the matches and comment on examples of ones that seem like true
positives and ones that seem like false matches

\textbf{Resources}:

\begin{itemize}
\tightlist
\item
  Solutions code here:
  https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/activities/05\_merging\_session2\_activitysolutions.ipynb
\item
  Example code here:
  https://github.com/rebeccajohnson88/qss20\_slides\_activities/blob/main/activities/05\_merging\_session2\_codeexample.ipynb
\end{itemize}

\textbf{Hint}: you may need to deduplicate multiple records in the
datasets for the recordlinkage package to work. See drop\_duplicates
within pandas and subset command

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{174}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{} Rename columns that are going to be matched}

\PY{n}{debar\PYZus{}new} \PY{o}{=} \PY{n}{debar\PYZus{}new}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{jobs} \PY{o}{=} \PY{n}{jobs}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{}\PYZsh{} Rename two digit state code column in jobs dataset}
\PY{n}{jobs} \PY{o}{=} \PY{n}{jobs}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}STATE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} \PYZsh{} deduplicate}
\PY{n}{debar\PYZus{}new}\PY{o}{=}\PY{n}{debar\PYZus{}new}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{name\PYZus{}4match}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{n}{jobs}\PY{o}{=}\PY{n}{jobs}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{name\PYZus{}4match}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} \PYZsh{}\PYZsh{} initialize indexer}
\PY{n}{matcher} \PY{o}{=} \PY{n}{recordlinkage}\PY{o}{.}\PY{n}{Index}\PY{p}{(}\PY{p}{)}
\PY{n}{matcher}\PY{o}{.}\PY{n}{block}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{state}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{candidate\PYZus{}links} \PY{o}{=} \PY{n}{matcher}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{debar\PYZus{}new}\PY{p}{,} \PY{n}{jobs}\PY{p}{)}
\PY{n}{candidate\PYZus{}links}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{174}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<Index>
\end{Verbatim}
\end{tcolorbox}
        
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{174}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
MultiIndex([( 0,   30),
            ( 0,   74),
            ( 0,  109),
            ( 0,  122),
            ( 0,  134),
            ( 0,  142),
            ( 0,  190),
            ( 0,  229),
            ( 0,  258),
            ( 0,  297),
            {\ldots}
            (94, 1064),
            (94, 1293),
            (94, 1426),
            (94, 1796),
            (94, 2061),
            (95,  256),
            (95,  662),
            (95,  691),
            (95, 1049),
            (95, 2051)],
           length=9088)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{178}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{compare} \PY{o}{=} \PY{n}{recordlinkage}\PY{o}{.}\PY{n}{Compare}\PY{p}{(}\PY{p}{)}

\PY{n}{thres} \PY{o}{=} \PY{l+m+mf}{0.85}
\PY{n}{compare}\PY{o}{.}\PY{n}{string}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jarowinkler}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{threshold}\PY{o}{=}\PY{n}{thres}\PY{p}{)}

\PY{n}{compare\PYZus{}vectors} \PY{o}{=} \PY{n}{compare}\PY{o}{.}\PY{n}{compute}\PY{p}{(}\PY{n}{candidate\PYZus{}links}\PY{p}{,} \PY{n}{debar\PYZus{}new}\PY{p}{,} \PY{n}{jobs}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{compare\PYZus{}vectors}\PY{p}{)}\PY{p}{)}

\PY{n}{compare\PYZus{}vectors}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{178}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<Compare>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{178}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
           0
0  30    0.0
   74    0.0
   109   0.0
   122   0.0
   134   0.0
{\ldots}      {\ldots}
95 256   0.0
   662   0.0
   691   0.0
   1049  0.0
   2051  0.0

[9088 rows x 1 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{} For the steps after compute, just take any match with non\PYZhy{}zero value rather than using a classifier }
\PY{c+c1}{\PYZsh{}\PYZsh{} so skip the k\PYZhy{}means or e\PYZhy{}m step in the example code}
\PY{n}{compare\PYZus{}vectors}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{df\PYZus{}resultsfromcompute}\PY{o}{=}\PY{n}{compare\PYZus{}vectors}\PY{p}{[}\PY{p}{(}\PY{n}{compare\PYZus{}vectors}\PY{o}{.}\PY{n}{name} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
\PY{n}{df\PYZus{}resultsfromcompute}\PY{o}{=}\PY{n}{df\PYZus{}resultsfromcompute}\PY{o}{.}\PY{n}{index}


\PY{n}{indices\PYZus{}debar} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{df\PYZus{}resultsfromcompute}\PY{p}{]}
\PY{n}{indices\PYZus{}jobs} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{df\PYZus{}resultsfromcompute}\PY{p}{]}

\PY{n}{df\PYZus{}matchpairs} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{debar\PYZus{}indices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{indices\PYZus{}debar}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jobs\PYZus{}indices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{indices\PYZus{}jobs}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index\PYZus{}4merge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{debar\PYZus{}new}\PY{o}{.}\PY{n}{index}
\PY{n}{jobs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index\PYZus{}4merge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{jobs}\PY{o}{.}\PY{n}{index}


\PY{n}{df\PYZus{}matchpairs\PYZus{}debar} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}matchpairs}\PY{p}{,}
                            \PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                            \PY{n}{how} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                            \PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{debar\PYZus{}indices}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                            \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{df\PYZus{}matchpairs\PYZus{}both} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}matchpairs\PYZus{}debar}\PY{p}{,}
                              \PY{n}{jobs}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                              \PY{n}{how} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                              \PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{jobs\PYZus{}indices}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                              \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                              \PY{n}{suffixes}\PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}debar}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}jobs}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{df\PYZus{}matchpairs\PYZus{}both}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    debar\_indices  jobs\_indices                 name\_4match\_debar state\_debar  \textbackslash{}
0              44           358                         F\&W FARMS          KS
1              44          1701                         F\&W FARMS          KS
2               3          1674                  TRIANGLE J FARMS          TX
3               7           637                    RAFAEL BARAJAS          FL
4              18           526                      GERMAN FARMS          ND
5              80          1150                       OLSON FARMS          ND
6              24           339           AVOYELLES HONEY CO, LLC          LA
7              92          1499                       J \& L FARMS          SD
8              46           894              SLASH E.V. RANCH LLP          CO
9              91           835  LOV RANCH CO, LLLP DBA LOV RANCH          CO
10             73          1007                     DIXIE BELL \#2          SC

    index\_4merge\_debar                  name\_4match\_jobs state\_jobs  \textbackslash{}
0                   44                         D\&L FARMS         KS
1                   44                         L\&E FARMS         KS
2                    3         TRIANGLE TURF COMPANY INC         TX
3                    7                    RAFAEL BARAJAS         FL
4                   18                     TESSMAN FARMS         ND
5                   80                      NELSON FARMS         ND
6                   24  AVOYELLES CRAWFISH \& SEAFOOD LLC         LA
7                   92                       S \& S FARMS         SD
8                   46                    SLASH EV RANCH         CO
9                   91                         LOV RANCH         CO
10                  73                  DIXIE BELLE, INC         SC

    index\_4merge\_jobs
0                 358
1                1701
2                1674
3                 637
4                 526
5                1150
6                 339
7                1499
8                 894
9                 835
10               1007
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{} True positive matches:}
\PY{c+c1}{\PYZsh{}\PYZsh{} TRIANGLE J FARMS/TRIANGLE TURF COMPANY INC\PYZgt{}\PYZgt{} both have traingle in it as the main name}
\PY{c+c1}{\PYZsh{}\PYZsh{} RAFAEL BARAJAS/RAFAEL BARAJAS\PYZgt{}\PYZgt{} (perfect match)}
\PY{c+c1}{\PYZsh{}\PYZsh{} SLASH E.V. RANCH LLP/SLASH EV RANCH\PYZgt{}\PYZgt{}nearly perfect match despite a slight punctuation difference}
\PY{c+c1}{\PYZsh{}\PYZsh{} LOV RANCH CO, LLLP DBA LOV RANCH/LOV RANCH\PYZgt{}\PYZgt{}nearly perfect match despite a slight punctuation difference and business type specification}
\PY{c+c1}{\PYZsh{}\PYZsh{} AVOYELLES HONEY C, LLC/AVOYELLES CRAWFISH \PYZam{} SEAFOOD LLC\PYZgt{}\PYZgt{}both have AVOYELLES in it as the main name}
\PY{c+c1}{\PYZsh{}\PYZsh{} DIXIE BELL \PYZsh{}2/DIXIE BELLE, IN\PYZgt{}\PYZgt{}nearly perfect match despite a slight business type label difference}

\PY{c+c1}{\PYZsh{}\PYZsh{} False positive matches:}
\PY{c+c1}{\PYZsh{}\PYZsh{} F\PYZam{}W FARMS/D\PYZam{}L FARMS \PYZgt{}\PYZgt{}quite different company names\PYZsq{} acromym, so probably not the real match}
\PY{c+c1}{\PYZsh{}\PYZsh{} F\PYZam{}W FARMS/L\PYZam{}E FARMS \PYZgt{}\PYZgt{}quite different company names\PYZsq{} acromym, so probably not the real match}
\PY{c+c1}{\PYZsh{}\PYZsh{} GERMAN FARMS/TESSMAN FARMS \PYZgt{}\PYZgt{}it might match on \PYZdq{}man\PYZdq{} but these two farms have different names}
\PY{c+c1}{\PYZsh{}\PYZsh{} OLSON FARMS/NELSON FARMS \PYZgt{}\PYZgt{}it might match on \PYZdq{}son\PYZdq{} but these two farms have different names}
\PY{c+c1}{\PYZsh{}\PYZsh{} J \PYZam{} L FARMS/S \PYZam{} S FARMS \PYZgt{}\PYZgt{}quite different company names\PYZsq{} acromym, so probably not the real match}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{write-a-fuzzy-matching-function-6-points}{%
\subsubsection{1.4.3 write a fuzzy matching function (6
points)}\label{write-a-fuzzy-matching-function-6-points}}

You want to see how the matches change if you add the town and not only
state as a field and also want to automate the process of matching a bit
to try different distance thresholds.

A. Extract the City from the \texttt{City,\ State} column of debar

B. Convert that new \texttt{city} column to uppercase and convert the
\texttt{EMPLOYER\_CITY} column in jobs to uppercase

C. Write a function surrounding the code in \texttt{recordlinkage} (so
you don't need to recode the package from scratch) that (1) takes in
each dataset, (2) blocks on two-digit state, and (3) fuzzy matches on
employer name and employer city

D. Execute the function with a couple different string distance
thresholds and print the results of each

5 out of 6 points: function takes arguments for input datasets, varname
to block on, two varnames to fuzzy match on, string distance function,
and string distance threshold

6 out of 6: above but function is also general enough that it takes a
variable \# of strings to match on--- so should work if you either
execute just using employer name or also work if you execute using
employer name and employer city

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{181}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{=}\PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{City, State}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{string}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{(,).*}\PY{l+s+s2}{\PYZdq{}} \PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{regex} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{=}\PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{jobs}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{=}\PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{jobs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EMPLOYER\PYZus{}CITY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{jobs}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{city}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{string}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{181}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
0             PORTLAND
1          MCMINNVILLE
2           LIVINGSTON
3             BROCKTON
4         WINTER HAVEN
             {\ldots}
2129           OAKLAND
2130            ELKTON
2131    AMERICAN FALLS
2132          BELLEVUE
2133        ORWIGSBURG
Name: city, Length: 2134, dtype: string
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{182}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{fuzzy\PYZus{}matching}\PY{p}{(}\PY{n}{data1}\PY{p}{,}\PY{n}{data2}\PY{p}{,}\PY{n}{sd\PYZus{}func}\PY{p}{,}\PY{n}{thres}\PY{p}{,}\PY{n}{bvarname}\PY{p}{,}\PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}\PY{p}{:}
    \PY{n}{lst} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n}{kwargs}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{n}{lst}\PY{p}{[}\PY{n}{key}\PY{p}{]} \PY{o}{=} \PY{n}{value}
    \PY{n}{matcher} \PY{o}{=} \PY{n}{recordlinkage}\PY{o}{.}\PY{n}{Index}\PY{p}{(}\PY{p}{)}
    \PY{n}{matcher}\PY{o}{.}\PY{n}{block}\PY{p}{(}\PY{n}{bvarname}\PY{p}{)}
    \PY{n}{candidate\PYZus{}links} \PY{o}{=} \PY{n}{matcher}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{data1}\PY{p}{,} \PY{n}{data2}\PY{p}{)}
    
    \PY{n}{compare} \PY{o}{=} \PY{n}{recordlinkage}\PY{o}{.}\PY{n}{Compare}\PY{p}{(}\PY{p}{)}
    \PY{k}{for} \PY{n}{key} \PY{o+ow}{in} \PY{n}{lst}\PY{p}{:}
        \PY{n}{compare}\PY{o}{.}\PY{n}{string}\PY{p}{(}\PY{n}{lst}\PY{p}{[}\PY{n}{key}\PY{p}{]}\PY{p}{,} \PY{n}{lst}\PY{p}{[}\PY{n}{key}\PY{p}{]}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{n}{sd\PYZus{}func}\PY{p}{,} \PY{n}{threshold}\PY{o}{=}\PY{n}{thres}\PY{p}{)}
    \PY{n}{compare\PYZus{}vectors} \PY{o}{=} \PY{n}{compare}\PY{o}{.}\PY{n}{compute}\PY{p}{(}\PY{n}{candidate\PYZus{}links}\PY{p}{,} \PY{n}{data1}\PY{p}{,} \PY{n}{data2}\PY{p}{)}

    \PY{n}{kmeans} \PY{o}{=} \PY{n}{recordlinkage}\PY{o}{.}\PY{n}{KMeansClassifier}\PY{p}{(}\PY{p}{)}
    \PY{n}{kmeans\PYZus{}results} \PY{o}{=} \PY{n}{kmeans}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{compare\PYZus{}vectors}\PY{p}{)}

    \PY{n}{indices\PYZus{}debar} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{kmeans\PYZus{}results}\PY{p}{]}
    \PY{n}{indices\PYZus{}jobs} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{kmeans\PYZus{}results}\PY{p}{]}

    \PY{n}{df\PYZus{}matchpairs} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{debar\PYZus{}indices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{indices\PYZus{}debar}\PY{p}{,}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jobs\PYZus{}indices}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{indices\PYZus{}jobs}\PY{p}{\PYZcb{}}\PY{p}{)}

    \PY{n}{debar\PYZus{}new}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index\PYZus{}4merge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{debar\PYZus{}new}\PY{o}{.}\PY{n}{index}
    \PY{n}{jobs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index\PYZus{}4merge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{jobs}\PY{o}{.}\PY{n}{index}
    
    \PY{n}{values}\PY{o}{=}\PY{n}{lst}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}
    \PY{n}{comparelist} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{values}\PY{p}{)}
    \PY{n}{comparelist}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{bvarname}\PY{p}{)}
    \PY{n}{comparelist}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{df\PYZus{}matchpairs\PYZus{}debar} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}matchpairs}\PY{p}{,} \PY{n}{data1}\PY{p}{[}\PY{n}{comparelist}\PY{p}{]}\PY{p}{,} \PY{n}{how} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                \PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{debar\PYZus{}indices}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{df\PYZus{}matchpairs\PYZus{}both} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}matchpairs\PYZus{}debar}\PY{p}{,} \PY{n}{data2}\PY{p}{[}\PY{n}{comparelist}\PY{p}{]}\PY{p}{,} \PY{n}{how} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                      \PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{jobs\PYZus{}indices}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{index\PYZus{}4merge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                      \PY{n}{suffixes}\PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}debar}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}jobs}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
    \PY{k}{return} \PY{n}{df\PYZus{}matchpairs\PYZus{}both}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0.7 threshold two mvarname}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{fuzzy\PYZus{}matching}\PY{p}{(}\PY{n}{data1}\PY{o}{=}\PY{n}{debar\PYZus{}new}\PY{p}{,} \PY{n}{data2}\PY{o}{=}\PY{n}{jobs}\PY{p}{,}\PY{n}{sd\PYZus{}func}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jarowinkler}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{thres}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{n}{bvarname}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname1}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname2}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0.8 threshold two mvarname}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{fuzzy\PYZus{}matching}\PY{p}{(}\PY{n}{data1}\PY{o}{=}\PY{n}{debar\PYZus{}new}\PY{p}{,} \PY{n}{data2}\PY{o}{=}\PY{n}{jobs}\PY{p}{,}\PY{n}{sd\PYZus{}func}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jarowinkler}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{thres}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{n}{bvarname}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname1}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname2}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0.9 threshold two mvarname}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{fuzzy\PYZus{}matching}\PY{p}{(}\PY{n}{data1}\PY{o}{=}\PY{n}{debar\PYZus{}new}\PY{p}{,} \PY{n}{data2}\PY{o}{=}\PY{n}{jobs}\PY{p}{,}\PY{n}{sd\PYZus{}func}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jarowinkler}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{thres}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{n}{bvarname}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname1}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname2}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0.9 threshold one mvarname}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{fuzzy\PYZus{}matching}\PY{p}{(}\PY{n}{data1}\PY{o}{=}\PY{n}{debar\PYZus{}new}\PY{p}{,} \PY{n}{data2}\PY{o}{=}\PY{n}{jobs}\PY{p}{,}\PY{n}{sd\PYZus{}func}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jarowinkler}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{thres}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{n}{bvarname}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{mvarname2}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name\PYZus{}4match}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
0.7 threshold two mvarname
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{182}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   debar\_indices  jobs\_indices   city\_debar                 name\_4match\_debar  \textbackslash{}
0             85           103        LYONS                  DAVID C MARTINEZ
1             18          1995    FULLERTON                      GERMAN FARMS
2             24           339  MOREAUVILLE           AVOYELLES HONEY CO, LLC
3             46           894        RIFLE              SLASH E.V. RANCH LLP
4             69           835        RIFLE                    E.V. RANCH LLP
5             91           835        RIFLE  LOV RANCH CO, LLLP DBA LOV RANCH

  state\_debar  index\_4merge\_debar    city\_jobs  \textbackslash{}
0          GA                  85        LYONS
1          ND                  18      FLAXTON
2          LA                  24  MOREAUVILLE
3          CO                  46        RIFLE
4          CO                  69        RIFLE
5          CO                  91        RIFLE

                   name\_4match\_jobs state\_jobs  index\_4merge\_jobs
0                  JOSE H. MARTINEZ         GA                103
1                       SORUM FARMS         ND               1995
2  AVOYELLES CRAWFISH \& SEAFOOD LLC         LA                339
3                    SLASH EV RANCH         CO                894
4                         LOV RANCH         CO                835
5                         LOV RANCH         CO                835
\end{Verbatim}
\end{tcolorbox}
        
    \begin{Verbatim}[commandchars=\\\{\}]
0.8 threshold two mvarname
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{182}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   debar\_indices  jobs\_indices   city\_debar                 name\_4match\_debar  \textbackslash{}
0             24           339  MOREAUVILLE           AVOYELLES HONEY CO, LLC
1             46           894        RIFLE              SLASH E.V. RANCH LLP
2             91           835        RIFLE  LOV RANCH CO, LLLP DBA LOV RANCH

  state\_debar  index\_4merge\_debar    city\_jobs  \textbackslash{}
0          LA                  24  MOREAUVILLE
1          CO                  46        RIFLE
2          CO                  91        RIFLE

                   name\_4match\_jobs state\_jobs  index\_4merge\_jobs
0  AVOYELLES CRAWFISH \& SEAFOOD LLC         LA                339
1                    SLASH EV RANCH         CO                894
2                         LOV RANCH         CO                835
\end{Verbatim}
\end{tcolorbox}
        
    \begin{Verbatim}[commandchars=\\\{\}]
0.9 threshold two mvarname
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{182}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   debar\_indices  jobs\_indices city\_debar     name\_4match\_debar state\_debar  \textbackslash{}
0             46           894      RIFLE  SLASH E.V. RANCH LLP          CO

   index\_4merge\_debar city\_jobs name\_4match\_jobs state\_jobs  index\_4merge\_jobs
0                  46     RIFLE   SLASH EV RANCH         CO                894
\end{Verbatim}
\end{tcolorbox}
        
    \begin{Verbatim}[commandchars=\\\{\}]
0.9 threshold one mvarname
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{182}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   debar\_indices  jobs\_indices     name\_4match\_debar state\_debar  \textbackslash{}
0              7           637        RAFAEL BARAJAS          FL
1             46           894  SLASH E.V. RANCH LLP          CO
2             73          1007         DIXIE BELL \#2          SC

   index\_4merge\_debar  name\_4match\_jobs state\_jobs  index\_4merge\_jobs
0                   7    RAFAEL BARAJAS         FL                637
1                  46    SLASH EV RANCH         CO                894
2                  73  DIXIE BELLE, INC         SC               1007
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
